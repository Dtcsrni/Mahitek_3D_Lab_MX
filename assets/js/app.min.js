const e={PRICE_MARKUP:1,PRICE_STEP:10,MESSENGER_PAGE:"mahitek3dlabmx",PLACEHOLDER_IMAGE:"assets/img/placeholder-catalog.svg",DATA_PATHS:{brand:"assets/data/brand.json",productsBase:"data/products.json",promos:"data/promos.json",social:"data/social.json",faq:"data/faq.json"},DEBUG_MODE:!1},t={IDIOMAS_SOPORTADOS:["es-MX","es","en"],IDIOMA_PREDETERMINADO:"es-MX",obtenerIdioma(){try{const e=localStorage.getItem("idioma-preferido");if(e&&this.IDIOMAS_SOPORTADOS.includes(e))return e;const t=navigator.language||navigator.userLanguage||"";return t.toLowerCase().startsWith("es-mx")?"es-MX":t.toLowerCase().startsWith("es")?"es":t.toLowerCase().startsWith("en")?"en":this.IDIOMA_PREDETERMINADO}catch(e){return console.warn("Error detectando idioma:",e),this.IDIOMA_PREDETERMINADO}},guardarIdioma(e){try{return!!this.IDIOMAS_SOPORTADOS.includes(e)&&(localStorage.setItem("idioma-preferido",e),!0)}catch(e){return console.warn("Error guardando idioma:",e),!1}},"esEspa√±ol"(){return this.obtenerIdioma().startsWith("es")},esMexicano(){return"es-MX"===this.obtenerIdioma()},actualizarCintillo(){const e=document.querySelector(".cintillo-texto");if(!e)return;const t=n.obtener("cintillo.construccion");e.textContent=t,e.setAttribute("data-idioma",this.obtenerIdioma())},inicializar(){const t=this.obtenerIdioma();document.documentElement.setAttribute("lang",t),this.actualizarCintillo(),e.DEBUG_MODE&&(console.log("üåê Idioma detectado:",t),console.log("üá≤üáΩ Es mexicano:",this.esMexicano()))}},n={obtener(e){const n=t.obtenerIdioma(),a=this.textos[e];return a?a[n]||a[n.split("-")[0]]||a["es-MX"]||a.en||e:(console.warn(`Texto no encontrado: ${e}`),e)},textos:{"cintillo.construccion":{"es-MX":"‚ö° SITIO EN DESARROLLO ‚ö° PR√ìXIMAMENTE FUNCIONALIDAD COMPLETA ‚ö°",es:"‚ö° EN CONSTRUCCI√ìN ‚ö° PR√ìXIMAMENTE DISPONIBLE ‚ö°",en:"‚ö° UNDER DEVELOPMENT ‚ö° COMING SOON ‚ö°"},"sistema.cargando":{"es-MX":"Cargando...",es:"Cargando...",en:"Loading..."},"sistema.error":{"es-MX":"Error al cargar",es:"Error al cargar",en:"Loading error"},"sistema.sinResultados":{"es-MX":"No se encontraron resultados",es:"No se encontraron resultados",en:"No results found"},"productos.desde":{"es-MX":"Desde",es:"Desde",en:"From"},"productos.verMas":{"es-MX":"Ver m√°s detalles",es:"Ver m√°s detalles",en:"View more details"},"productos.disponible":{"es-MX":"Disponible",es:"Disponible",en:"Available"},"productos.agotado":{"es-MX":"Agotado",es:"Agotado",en:"Out of stock"},"promos.titulo":{"es-MX":"Promociones Especiales",es:"Promociones Especiales",en:"Special Offers"},"promos.ahorra":{"es-MX":"Ahorra",es:"Ahorra",en:"Save"},"promos.valido":{"es-MX":"V√°lido hasta",es:"V√°lido hasta",en:"Valid until"},"filtros.todos":{"es-MX":"Todos",es:"Todos",en:"All"},"filtros.categoria":{"es-MX":"Categor√≠a",es:"Categor√≠a",en:"Category"},"filtros.limpiar":{"es-MX":"Limpiar filtros",es:"Limpiar filtros",en:"Clear filters"},"contacto.messenger_main":{"es-MX":"Contactar por Messenger",es:"Contactar por Messenger",en:"Contact via Messenger"},"contacto.messenger":{"es-MX":"Enviar mensaje",es:"Enviar mensaje",en:"Send message"},"contacto.cotizar":{"es-MX":"Solicitar cotizaci√≥n",es:"Solicitar cotizaci√≥n",en:"Request quote"},"faq.titulo":{"es-MX":"Preguntas Frecuentes",es:"Preguntas Frecuentes",en:"Frequently Asked Questions"},"faq.ver":{"es-MX":"Ver respuesta",es:"Ver respuesta",en:"View answer"},"error.productos":{"es-MX":"Error al cargar productos. Por favor, intente nuevamente.",es:"Error al cargar productos. Por favor, intente nuevamente.",en:"Error loading products. Please try again."},"error.promos":{"es-MX":"Error al cargar promociones. Por favor, intente nuevamente.",es:"Error al cargar promociones. Por favor, intente nuevamente.",en:"Error loading promotions. Please try again."},"error.faq":{"es-MX":"Error al cargar preguntas frecuentes. Por favor, intente nuevamente.",es:"Error al cargar preguntas frecuentes. Por favor, intente nuevamente.",en:"Error loading FAQs. Please try again."},"error.red":{"es-MX":"Error de conexi√≥n. Verifique su conexi√≥n a internet.",es:"Error de conexi√≥n. Verifique su conexi√≥n a internet.",en:"Connection error. Please check your internet connection."},"debug.iniciado":{"es-MX":"Sistema iniciado correctamente",es:"Sistema iniciado correctamente",en:"System started successfully"},"debug.productosOK":{"es-MX":"Productos cargados",es:"Productos cargados",en:"Products loaded"},"debug.promosOK":{"es-MX":"Promociones cargadas",es:"Promociones cargadas",en:"Promotions loaded"},"debug.faqOK":{"es-MX":"Preguntas frecuentes cargadas",es:"Preguntas frecuentes cargadas",en:"FAQs loaded"}}},a=window.matchMedia("(prefers-reduced-motion: reduce)");let o=null;const s={callbacks:new Set,timeout:null,ticking:!1,DEBOUNCE_MS:150,register(e){this.callbacks.add(e),e()},unregister(e){this.callbacks.delete(e)},handleResize(){this.ticking||(this.ticking=!0,requestAnimationFrame(()=>{clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.callbacks.forEach(e=>{try{e()}catch(e){console.error("Resize callback error:",e)}}),this.ticking=!1},this.DEBOUNCE_MS)}))},init(){window.addEventListener("resize",()=>this.handleResize(),{passive:!0})}};function r(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function i(e,{allowRelative:t=!0}={}){try{const n=String(e||"").trim();if(!n)return"#";if(t&&(n.startsWith("/")||n.startsWith("./")||n.startsWith("../")))return n;const a=new URL(n,window.location.origin);if(["http:","https:","mailto:","tel:"].includes(a.protocol))return a.href}catch(e){}return"#"}function c(e,t={}){try{"function"==typeof gtag&&gtag("event",e,t)}catch(e){}}async function l(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`${n.obtener("error.red")} (${e})`);return await t.json()}catch(t){return console.error(`‚ùå ${n.obtener("sistema.error")}: ${e}`,t),null}}function d(e){if(!(e&&e instanceof Element))return;if(a.matches)return e.matches("[data-animate]")&&e.classList.add("is-visible"),void e.querySelectorAll("[data-animate]").forEach(e=>e.classList.add("is-visible"));if(!o)return;const t=[];e.matches("[data-animate]")&&!e.classList.contains("is-visible")&&t.push(e),e.querySelectorAll("[data-animate]").forEach(e=>{e.classList.contains("is-visible")||t.push(e)}),t.forEach(e=>o.observe(e))}s.init();let u=[],m=[];async function p(){const t=await l(e.DATA_PATHS.productsBase);t&&(u=t.filter(e=>"activo"===e.estado),m=[...u],g(),function(){const e=document.getElementById("category-filter");if(!e)return;const t=[...new Set(u.map(e=>e.categoria))];e.innerHTML="";const n=document.createElement("option");n.value="todas",n.textContent="Todas",e.appendChild(n),t.forEach(t=>{if(!t)return;const n=document.createElement("option");n.value=String(t),n.textContent=String(t),e.appendChild(n)})}())}function g(){const t=document.getElementById("product-carousel");if(t){if(0===m.length)return t.innerHTML='\n      <div class="card glass placeholder-card" data-animate="fade-up">\n        <img src="assets/img/placeholder-catalog.svg" alt="Sin coincidencias en el cat√°logo" class="placeholder-illustration" width="320" height="240" loading="lazy" decoding="async" />\n        <p>No se encontraron productos con los filtros seleccionados. Ajusta los filtros o cu√©ntanos qu√© est√°s buscando.</p>\n      </div>\n    ',void d(t);t.innerHTML=m.map((t,n)=>{Math.min(n,5);const a=t.imagen&&!t.imagen.startsWith("/")&&!String(t.imagen).includes("."),o=r(t.nombre||""),s=a?`<div class="product-emoji">${r(t.imagen)}</div>`:`<img class="product-image" src="${i(t.imagen||e.PLACEHOLDER_IMAGE)}" alt="${o}" data-placeholder="${e.PLACEHOLDER_IMAGE}" loading="lazy" decoding="async" />`,l=[{label:"Material",value:t.material},{label:"Incluye",value:t.incluye},{label:"Variantes",value:t.variantes}].filter(e=>e.value),d=l.length?`\n        <dl class="product-details">\n          ${l.map(e=>`\n            <div>\n              <dt>${r(e.label)}</dt>\n              <dd>${r(e.value)}</dd>\n            </div>\n          `).join("")}\n        </dl>\n      `:"",u=t.tags&&t.tags.length?`\n        <div class="product-tags">\n          ${t.tags.map(e=>`<span class="tag">${r(e)}</span>`).join("")}\n        </div>\n      `:"",m=t.sugerencias?`<p class="product-suggestions">üí° <strong>Sugerencias:</strong> ${r(t.sugerencias)}</p>`:"";return c("view_item",{item_id:t.id,item_name:t.nombre,price:t.precio_mxn,item_category:t.categoria}),`\n  <article class="card glass product-card animate-delay-${Math.min(n,5)}" role="listitem" data-animate="fade-up">\n      <div class="product-media">\n        ${s}\n      </div>\n      <div class="product-meta">\n        <span class="product-sku">${r(t.id||"")}</span>\n        ${t.categoria?`<span class="product-line">${r(t.categoria)}</span>`:""}\n      </div>\n  <h3 class="product-name">${o}</h3>\n  <p class="product-price">${t.precio_rango_mxn?`$${r(String(t.precio_rango_mxn))} MXN`:`$${r(String(t.precio_mxn))} MXN`}</p>\n  <p class="product-price-note">Rango por personalizaci√≥n, tama√±o/grosor, acabados, herrajes/adhesivos, alcance y tirada.</p>\n      <p class="product-description">${r(t.descripcion||"")}</p>\n      ${d}\n      ${u}\n      ${m}\n      <a href="${function(t){const n=`https://m.me/${e.MESSENGER_PAGE}`;return t?`${n}?ref=${encodeURIComponent(t)}`:n}(`product:${encodeURIComponent(t.id||"")}|${encodeURIComponent(t.nombre)}`)}" \n         class="btn btn-primary product-cta" \n         target="_blank" \n         rel="noopener noreferrer" \n         data-sku="${t.id}" \n         data-name="${r(t.nombre)}">\n        Consultar disponibilidad en Messenger\n      </a>\n    </article>\n  `}).join(""),d(t),function(t){if(!t)return;t.querySelectorAll("img.product-image").forEach(t=>{t.addEventListener("error",function(){const t=this.getAttribute("data-placeholder")||e.PLACEHOLDER_IMAGE;this.src!==t&&(this.src=t)},{once:!0})})}(t),function(e){const t=document.getElementById("product-carousel"),n=document.querySelector(".carousel-btn-prev"),a=document.querySelector(".carousel-btn-next"),o=document.getElementById("catalog-dots");if(!(t&&n&&a&&o))return;let r=0,i=1;function l(){i=window.innerWidth>=1024?3:window.innerWidth>=768?2:1}function d(){return Math.ceil(e/i)}function u(){const e=100/i*-r;t.style.transform=`translateX(${e}%)`,m(),g()}function m(){const e=d();n.disabled=0===r,a.disabled=r>=e-1}function p(){const e=d();o.innerHTML="";for(let t=0;t<e;t++){const e=document.createElement("button");e.classList.add("carousel-dot"),e.setAttribute("aria-label",`Ir a p√°gina ${t+1}`),t===r&&e.classList.add("active"),e.addEventListener("click",()=>{r=t,u(),c("catalog_carousel_navigation",{method:"dot",index:r})}),o.appendChild(e)}}function g(){o.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===r)})}n.addEventListener("click",()=>{r>0&&(r--,u(),c("catalog_carousel_navigation",{method:"button",direction:"prev",index:r}))}),a.addEventListener("click",()=>{const e=d();r<e-1&&(r++,u(),c("catalog_carousel_navigation",{method:"button",direction:"next",index:r}))});let h=0,f=0;function v(){const e=50,t=h-f;Math.abs(t)>e&&(t>0?a.click():n.click(),c("catalog_carousel_navigation",{method:"swipe",direction:t>0?"next":"prev"}))}t.addEventListener("touchstart",e=>{h=e.changedTouches[0].screenX},{passive:!0}),t.addEventListener("touchend",e=>{f=e.changedTouches[0].screenX,v()},{passive:!0});const b=()=>{const e=i;l(),e!==i&&(r=0,p(),u())};s.register(b),l(),p(),u(),c("catalog_carousel_init",{items:e,itemsPerView:i})}(m.length),t.addEventListener("click",e=>{const t=e.target.closest(".product-cta");t&&c("add_to_cart",{item_id:t.getAttribute("data-sku")||"",item_name:t.getAttribute("data-name")||""})},{once:!0})}}function h(){const e=document.getElementById("category-filter")?.value||"todas",t=document.getElementById("search-input")?.value.toLowerCase()||"";m=u.filter(n=>{const a="todas"===e||n.categoria===e,o=!t||n.nombre.toLowerCase().includes(t)||(n.descripcion||"").toLowerCase().includes(t)||(n.id||"").toLowerCase().includes(t)||n.tags?.some(e=>e.toLowerCase().includes(t));return a&&o}),g()}let f=!1;async function v(){if(f)return;const t=await l(e.DATA_PATHS.promos),n=document.getElementById("promos-container");if(!n)return;f=!0;const a=new Date,o=t&&t.length>0?t.filter(e=>{if(e.estado&&"inactivo"===e.estado)return!1;if(!e.desde||!e.hasta)return"activo"===e.estado;const t=new Date(e.desde),n=new Date(e.hasta);return a>=t&&a<=n}):[],{PACKS:u}=await import("./promos.js"),m=[{name:"Redondo",svg:'<svg width="80" height="80" viewBox="0 0 80 80" fill="none"><circle cx="40" cy="40" r="32" fill="#0ff" stroke="#ff00cc" stroke-width="6"><animate attributeName="r" values="32;36;32" dur="1.2s" repeatCount="indefinite"/></circle><g><text x="40" y="48" text-anchor="middle" font-size="24" fill="#fff" font-family="monospace">‚óè</text></g><g><path d="M20 60 Q40 70 60 60" stroke="#ffea00" stroke-width="2" fill="none"/></g></svg>'},{name:"Cuadrado",svg:'<svg width="80" height="80" viewBox="0 0 80 80" fill="none"><rect x="16" y="16" width="48" height="48" rx="12" fill="#ff00cc" stroke="#0ff" stroke-width="6"><animate attributeName="rx" values="12;20;12" dur="1.2s" repeatCount="indefinite"/></rect><g><text x="40" y="48" text-anchor="middle" font-size="24" fill="#fff" font-family="monospace">‚ñ†</text></g><g><path d="M24 24 L56 56" stroke="#ffea00" stroke-width="2"/></g></svg>'},{name:"Rectangular",svg:'<svg width="80" height="80" viewBox="0 0 80 80" fill="none"><rect x="10" y="28" width="60" height="24" rx="8" fill="#ffea00" stroke="#00ffd0" stroke-width="6"><animate attributeName="width" values="60;66;60" dur="1.2s" repeatCount="indefinite"/></rect><g><text x="40" y="48" text-anchor="middle" font-size="24" fill="#222" font-family="monospace">‚ñ¨</text></g><g><path d="M20 40 Q40 60 60 40" stroke="#ff00cc" stroke-width="2" fill="none"/></g></svg>'},{name:"Troquelado",svg:'<svg width="80" height="80" viewBox="0 0 80 80" fill="none"><path d="M16,40 Q40,12 64,40 Q40,68 16,40 Z" fill="#00ffd0" stroke="#ff00cc" stroke-width="6"><animate attributeName="d" values="M16,40 Q40,12 64,40 Q40,68 16,40 Z;M20,36 Q40,20 60,36 Q40,64 20,36 Z;M16,40 Q40,12 64,40 Q40,68 16,40 Z" dur="1.2s" repeatCount="indefinite"/></path><g><text x="40" y="48" text-anchor="middle" font-size="24" fill="#222" font-family="monospace">‚ú¶</text></g><g><path d="M24 60 Q40 72 56 60" stroke="#ffea00" stroke-width="2" fill="none"/></g></svg>'}],p=u.map((e,t)=>{const n=(e.price/e.units).toFixed(2),a=3*e.units,o=Math.max(0,a-e.price);let s="";e.units>=25?s+='<span class="badge badge--value">Mejor valor</span> ':10===e.units?s+='<span class="badge badge--bestseller">M√°s vendido</span> ':2===e.units&&(s+='<span class="badge badge--entry">Entrada</span> ');const r=o>0?`<span class="badge badge-save">Ahorra $${o}</span>`:"",i=m[t%m.length].svg,c=m[t%m.length].name;return`\n      <article class="card glass promo-card promo-sticker animate-delay-${Math.min(t,5)}" data-animate="fade-up" style="background: linear-gradient(135deg, #1a0033 60%, #0ff 100%); box-shadow: 0 0 24px #ff00cc55;">\n        <div class="promo-icono-container" style="margin-bottom:8px;">${i}</div>\n        <h3 class="promo-titulo" style="color:#ffea00;">${c} ${e.units} stickers</h3>\n        <div class="card-body">\n          <h3 class="promo-price" style="color:#0ff;">$${e.price} MXN</h3>\n          <p class="promo-units" style="color:#fff;">${e.units} unidades</p>\n          <div class="promo-badges">${s}<span class="badge badge-ppu">$${n}/ud</span> ${r}</div>\n        </div>\n      </article>\n    `}),g=[...o.map((e,t)=>{const n=70*Math.min(t,5),a=e.destacado?"promo-destacado":"",o=e.animacion?`promo-anim-${e.animacion}`:"";e.color_acento;let s="";if(e.precio_regular){const t=e.precio_unitario?`<span class="promo-unitario">$${e.precio_unitario.toFixed(2)} c/u</span>`:"";s=`\n        <div class="promo-precio">\n          <span class="promo-precio-total">$${e.precio_regular}</span>\n          ${t}\n        </div>\n      `}else e.precio_especial?s=`\n        <div class="promo-precio">\n          <span class="promo-precio-especial">$${e.precio_especial}</span>\n        </div>\n      `:e.monto_minimo&&(s=`\n        <div class="promo-minimo">\n          <span>M√≠nimo: $${e.monto_minimo}</span>\n        </div>\n      `);const c=e.badge?`<span class="promo-badge">${r(e.badge)}</span>`:"",l=e.beneficios&&e.beneficios.length>0?`<ul class="promo-beneficios">${e.beneficios.map(e=>`<li>‚úì ${r(e)}</li>`).join("")}</ul>`:"";let d="";"permanente"===e.tipo?d='<p class="promo-validez">‚è∞ Promoci√≥n permanente</p>':e.desde&&e.hasta&&(d=`<p class="promo-validez">üìÖ V√°lido ${r(b(e.desde))} ‚Äì ${r(b(e.hasta))}</p>`);const u=e.cta_url?`<a href="${i(e.cta_url)}" class="btn btn-primary promo-cta" target="_blank" rel="noopener noreferrer" data-promo-id="${r(e.id)}" data-promo-name="${r(e.titulo)}">${r(e.cta_text||"M√°s info")}</a>`:`<button class="btn btn-primary promo-cta-contact" data-promo-id="${r(e.id)}" data-promo-name="${r(e.titulo)}">${r("Consultar por Messenger")}</button>`;let m="";return m=e.icono?e.icono.endsWith(".svg")?`<img src="${i(e.icono)}" alt="${r(e.titulo)}" class="promo-icon" width="200" height="200" loading="lazy" decoding="async" />`:`<span class="promo-emoji" aria-hidden="true">${r(e.icono)}</span>`:'<span class="promo-emoji" aria-hidden="true">üéÅ</span>',`<article class="card glass promo-card ${a} ${o} animate-delay-${n}" data-animate="fade-up" data-promo-tipo="${e.tipo}">${c?`<div class="promo-badge-wrapper">${c}</div>`:""}<div class="promo-icono-container">${m}</div><h3 class="promo-titulo">${r(e.titulo)}</h3><p class="promo-subtitulo">${r(e.subtitulo||e.descripcion||"")}</p>${s}${l}${d}${u}</article>`}),...p],h=document.querySelector("#promos .section-title");h&&g.length>0&&(h.innerHTML=`üéØ Promociones activas <span class="promo-count">(${g.length})</span>`),n.innerHTML=g.join(""),d(n),function(e){const t=document.querySelector(".carousel-track"),n=document.querySelector(".carousel-btn-prev"),a=document.querySelector(".carousel-btn-next"),o=document.getElementById("promos-dots");if(!(t&&n&&a&&o))return;let r=0,i=1;function c(){i=window.innerWidth>=1024?3:window.innerWidth>=768?2:1}function l(){return Math.ceil(e/i)}function d(){const e=100/i*-r;t.style.transform=`translateX(${e}%)`,u(),p()}function u(){const e=l();n.disabled=0===r,a.disabled=r>=e-1}function m(){const e=l();o.innerHTML="";for(let t=0;t<e;t++){const e=document.createElement("button");e.classList.add("carousel-dot"),e.setAttribute("aria-label",`Ir a p√°gina ${t+1}`),t===r&&e.classList.add("active"),e.addEventListener("click",()=>{r=t,d()}),o.appendChild(e)}}function p(){o.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===r)})}n.addEventListener("click",()=>{r>0&&(r--,d())}),a.addEventListener("click",()=>{const e=l();r<e-1&&(r++,d())});let g=0,h=0;function f(){const e=50,t=g-h;Math.abs(t)>e&&(t>0?a.click():n.click())}t.addEventListener("touchstart",e=>{g=e.changedTouches[0].screenX},{passive:!0}),t.addEventListener("touchend",e=>{h=e.changedTouches[0].screenX,f()},{passive:!0});const v=()=>{const e=i;c(),e!==i&&(r=0,m(),d())};s.register(v),c(),m(),d()}(g.length),n.addEventListener("click",e=>{const t=e.target.closest(".promo-cta");t&&c("select_promotion",{promotion_id:t.getAttribute("data-promo-id")||"",promotion_name:t.getAttribute("data-promo-name")||""})}),n.addEventListener("click",t=>{const n=t.target.closest(".promo-cta-contact");if(!n)return;const a=n.getAttribute("data-promo-name")||"Promoci√≥n";window.open(`https://m.me/${e.MESSENGER_PAGE}`,"_blank","noopener"),c("contact_promo",{promotion_id:n.getAttribute("data-promo-id")||"",promotion_name:a,platform:"messenger"})})}function b(e){return new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}let y=!1;async function E(){if(y)return;const t=await l(e.DATA_PATHS.faq),n=document.getElementById("faq-list");if(!n)return;if(y=!0,!t||0===t.length)return n.innerHTML='\n      <div class="card glass placeholder-card" data-animate="fade-up">\n        <img src="assets/img/placeholder-faq.svg" alt="Preguntas frecuentes en preparaci√≥n" class="placeholder-illustration" width="320" height="240" loading="lazy" decoding="async" />\n        <p>A√∫n estamos documentando las preguntas frecuentes. Escr√≠benos por Messenger y resolvemos tu caso.</p>\n      </div>\n    ',void d(n);n.innerHTML=t.map((e,t)=>{Math.min(t,5);const n=`faq-${w(e.q)}`;return`\n  <details class="faq-item animate-delay-${Math.min(t,5)}" id="${n}" data-animate="fade-up">\n      <summary><span>${r(e.q)}</span></summary>\n      <p>${r(e.a)}</p>\n    </details>\n  `}).join(""),d(n);const a=document.getElementById("faq-top");if(a){const e=t.filter(e=>e.destacada);e.length>0&&(a.innerHTML=e.map(e=>{const t=`faq-${w(e.q)}`;return`<a class="faq-chip" href="#${t}" data-faq-target="#${t}" aria-label="Ir a: ${r(e.q)}">‚≠ê ${r(e.q)}</a>`}).join(""),a.addEventListener("click",e=>{const t=e.target.closest("a.faq-chip");if(!t)return;const n=t.getAttribute("data-faq-target");if(!n)return;const a=document.querySelector(n);a&&a.classList.contains("faq-item")&&(a.open=!0,a.scrollIntoView({behavior:"smooth",block:"start"})),e.preventDefault()}))}const o=document.getElementById("faq-search"),s=document.getElementById("faq-category"),i=document.getElementById("faq-expand"),c=document.getElementById("faq-collapse"),u=document.getElementById("faq-count"),m=Array.from(n.querySelectorAll(".faq-item"));if(s){Array.from(new Set(t.map(e=>e.categoria).filter(Boolean))).sort().forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),s.appendChild(t)})}function p(e){const t=(e||"").trim().toLowerCase(),n=s&&s.value?s.value:"";let a=0;if(m.forEach(e=>{const o=e.textContent.toLowerCase(),s=0===t.length||o.includes(t),r=!n||o.includes(n)||e.querySelector("summary span")?.textContent.toLowerCase().includes(n),i=s&&r;e.style.display=i?"":"none",i&&a++}),u){const e=m.length;u.textContent=`Mostrando ${a} de ${e} preguntas`}}if(o&&o.addEventListener("input",e=>p(e.target.value)),s&&s.addEventListener("change",()=>p(o?o.value:"")),i&&i.addEventListener("click",()=>m.forEach(e=>e.open=!0)),c&&c.addEventListener("click",()=>m.forEach(e=>e.open=!1)),u&&(u.textContent=`Mostrando ${m.length} de ${m.length} preguntas`),location.hash&&location.hash.startsWith("#faq-")){const e=document.querySelector(location.hash);e&&e.classList.contains("faq-item")&&(e.open=!0,e.scrollIntoView({behavior:"smooth",block:"start"}))}try{!function(e){if(!Array.isArray(e)||0===e.length)return;const t={"@context":"https://schema.org","@type":"FAQPage",mainEntity:e.map(e=>({"@type":"Question",name:e.q,acceptedAnswer:{"@type":"Answer",text:e.a}}))},n=JSON.stringify(t);let a=document.getElementById("faq-schema");a||(a=document.createElement("script"),a.type="application/ld+json",a.id="faq-schema",document.head.appendChild(a));a.textContent=n}(t)}catch(e){console.warn("FAQ schema injection skipped:",e)}}function w(e){return String(e).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}async function M(){let t=null;const n=await l(e.DATA_PATHS.brand);if(t=n&&n.social?n.social:await l(e.DATA_PATHS.social),!t)return;const a=document.getElementById("social-links");if(a){const e=[];t.instagram&&e.push({key:"instagram",label:"Instagram",url:t.instagram}),t.facebook&&e.push({key:"facebook",label:"Facebook",url:t.facebook}),t.tiktok&&e.push({key:"tiktok",label:"TikTok",url:t.tiktok}),a.innerHTML=e.map(e=>`\n      <a class="social-icon social-icon--${e.key}" href="${i(e.url)}" target="_blank" rel="noopener noreferrer" aria-label="${r(e.label)}" title="${r(e.label)}">\n        ${$(e.key)}\n        <span class="sr-only">${r(e.label)}</span>\n      </a>\n    `).join("")}const o=document.getElementById("hero-social-links");if(o){const e=[];t.instagram&&e.push({key:"instagram",label:"Instagram",url:t.instagram,icon:"instagram"}),t.facebook&&e.push({key:"facebook",label:"Facebook",url:t.facebook,icon:"facebook"}),t.tiktok&&e.push({key:"tiktok",label:"TikTok",url:t.tiktok,icon:"tiktok"}),o.innerHTML=e.map(e=>`\n      <a class="community-link" href="${i(e.url)}" target="_blank" rel="noopener noreferrer" aria-label="${r(e.label)}">\n        ${$(e.key)}\n        <span>${r(e.label)}</span>\n      </a>\n    `).join("")}}function $(e){const t={instagram:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>',facebook:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',tiktok:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>',youtube:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>',twitter:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>'};return t[e]||t.instagram}function L(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav-menu"),n=document.querySelector(".header");if(!e||!t)return;const a=t.classList.contains("active");e.setAttribute("aria-expanded",String(a)),e.setAttribute("aria-label",a?"Cerrar men√∫":"Abrir men√∫");let o=!1;const r=()=>{o||(o=!0,t.classList.remove("active"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Abrir men√∫"),document.body.classList.remove("nav-open"),setTimeout(()=>{o=!1},350))};e.addEventListener("click",n=>{if(n.preventDefault(),n.stopPropagation(),o)return;const a=t.classList.contains("active");a?r():o||(o=!0,t.classList.add("active"),e.classList.add("active"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Cerrar men√∫"),document.body.classList.add("nav-open"),setTimeout(()=>{o=!1},350)),c("nav_menu_toggle",{state:a?"closed":"open"})}),t.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{r(),c("nav_link_click",{href:e.getAttribute("href")})})}),document.addEventListener("click",n=>{!t.classList.contains("active")||t.contains(n.target)||e.contains(n.target)||(r(),c("nav_menu_close",{method:"outside_click"}))}),document.addEventListener("keydown",n=>{"Escape"===n.key&&t.classList.contains("active")&&(r(),e.focus(),c("nav_menu_close",{method:"escape_key"}))});s.register(()=>{window.innerWidth>=768&&t.classList.contains("active")&&(r(),c("nav_menu_close",{method:"resize_to_desktop"}))}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t||!t)return;e.preventDefault();const a=document.querySelector(t);if(a){const e=n?n.offsetHeight:80,t=a.offsetTop-e;window.scrollTo({top:t,behavior:"smooth"})}})})}async function k(){t.inicializar(),function(){const e=document.documentElement,t=()=>{const t=.01*window.innerHeight;e.style.setProperty("--vh",`${t}px`)},n=()=>{const t=.01*window.innerWidth;e.style.setProperty("--vw",`${t}px`)},a=()=>{const t=document.querySelector(".header");t&&e.style.setProperty("--header-h",`${t.offsetHeight}px`)},o=()=>{try{const t=navigator.deviceMemory||2,n=navigator.hardwareConcurrency||2,a=window.matchMedia("(prefers-reduced-motion: reduce)").matches,o=window.matchMedia("(pointer: fine)").matches,s=t>=4&&n>=6&&!a&&o;e.classList.toggle("device-high",s),e.classList.toggle("device-low",!s)}catch(t){e.classList.add("device-low")}};t(),a(),n(),o(),window.addEventListener("resize",()=>{t(),a(),n()},{passive:!0}),window.addEventListener("orientationchange",()=>{t(),a(),n()})}(),function(){try{void 0===window.gtag&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer&&window.dataLayer.push(arguments)}),gtag("js",new Date),gtag("config","G-Y46M6J1EWS",{send_page_view:!0,anonymize_ip:!0})}catch(e){}}(),L(),function(){const e=document.getElementById("category-filter"),t=document.getElementById("search-input");e&&e.addEventListener("change",h),t&&t.addEventListener("input",h)}(),function(){const e=document.querySelector(".header");if(!e)return;let t=!1,n=0,a="up";const o=()=>{const o=window.scrollY,s=o-n;Math.abs(s)>5&&(a=s>0?"down":"up"),e.classList.toggle("is-scrolled",o>24),window.innerWidth<1024?e.classList.toggle("is-compact",o>300):e.classList.remove("is-compact");const r=document.body.classList.contains("nav-open"),i=o<100;"down"===a&&o>100&&!r?e.classList.add("is-hidden"):("up"===a||i||r)&&e.classList.remove("is-hidden"),n=o,t=!1};o(),window.addEventListener("scroll",()=>{t||(requestAnimationFrame(o),t=!0)},{passive:!0})}(),function(){const e=document.querySelectorAll("[data-animate]");e.length&&(a.matches?e.forEach(e=>e.classList.add("is-visible")):(o=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(setTimeout(()=>{e.target.classList.add("is-visible")},50),t.unobserve(e.target))})},{threshold:.15,rootMargin:"0px 0px -8% 0px"}),e.forEach(e=>o.observe(e))))}(),document.querySelectorAll(".email-link[data-email-user][data-email-domain]").forEach(e=>{const t=e.getAttribute("data-email-user"),n=e.getAttribute("data-email-domain");if(!t||!n)return;const a=`${t}@${n}`;e.setAttribute("href",`mailto:${a}`);const o=e.getAttribute("data-email-label");e.textContent.trim()&&!o||(e.textContent=o||a),e.setAttribute("rel",`${e.getAttribute("rel")||""} nofollow noopener noreferrer`)}),function(){try{const e={"@context":"https://schema.org","@type":"Organization",name:"Mahitek 3D Lab",url:"https://dtcsrni.github.io/Mahitek_3D_Lab_MX/",logo:"https://dtcsrni.github.io/Mahitek_3D_Lab_MX/assets/img/mark-icon.svg",sameAs:["https://www.instagram.com/mahitek3dlab","https://www.facebook.com/mahitek3dlab"],description:"Laboratorio de impresi√≥n 3D en PETG desde Pachuca, M√©xico. Creamos piezas personalizadas para regalos, decoraci√≥n y proyectos creativos.",address:{"@type":"PostalAddress",addressLocality:"Pachuca",addressRegion:"Hidalgo",addressCountry:"MX"},contactPoint:{"@type":"ContactPoint",contactType:"Customer Support",email:"armsystechno@gmail.com",url:"https://m.me/mahitek3dlabmx"}},t=document.createElement("script");t.type="application/ld+json",t.id="org-schema",t.textContent=JSON.stringify(e),document.head.appendChild(t)}catch(e){}}(),await Promise.all([p(),M()]),function(){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const n=t.target,a=n.id;"promos"!==a||f?"faq"!==a||y||(E(),e.unobserve(n)):(v(),e.unobserve(n))}})},{rootMargin:"200px"}),t=document.getElementById("promos"),n=document.getElementById("faq");t&&e.observe(t),n&&e.observe(n)}(),function(){const e=new URLSearchParams(location.search),t=e.get("m"),n=e.get("q"),a=e.get("p"),o=document.getElementById("category-filter"),s=document.getElementById("search-input");let r=!1;t&&o&&(o.value=t,r=!0);n&&s&&(s.value=n,r=!0);r&&h();if(a){const e=[...document.querySelectorAll(".product-card")].find(e=>e.querySelector(".product-sku")?.textContent.includes(a));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.outline="2px solid rgba(6, 182, 212, 0.7)",setTimeout(()=>{e.style.outline="none"},2e3))}const i=()=>{const e=new URLSearchParams(location.search),t=o?.value&&"todas"!==o.value?o.value:"",n=s?.value?.trim()||"";t?e.set("m",t):e.delete("m"),n?e.set("q",n):e.delete("q"),history.replaceState(null,"",`${location.pathname}${e.toString()?`?${e}`:""}`)};o&&o.addEventListener("change",i);s&&s.addEventListener("input",i)}(),e.DEBUG_MODE&&(console.log(`‚úÖ ${n.obtener("debug.iniciado")}`),console.log(`üìä ${n.obtener("debug.productosOK")}: ${u.length}`),console.log(`üí∞ Margen de precio: ${e.PRICE_MARKUP} (${100*(e.PRICE_MARKUP-1)}%)`),console.log(`üîÑ Redondeo: $${e.PRICE_STEP} MXN`))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",k):k(),window.MahitekLab={config:e,calculateSalePrice:function(t,n=e.PRICE_MARKUP,a=e.PRICE_STEP){const o=t*n;return Math.round(o/a)*a},products:()=>u,filterProducts:h};