const e={PRICE_MARKUP:1,PRICE_STEP:10,MESSENGER_PAGE:"mahitek3dlabmx",PLACEHOLDER_IMAGE:"assets/img/placeholder-catalog.svg",DATA_PATHS:{brand:"assets/data/brand.json",productsBase:"data/products.json",promos:"data/promos.json",social:"data/social.json",faq:"data/faq.json"},DEBUG_MODE:!1},t=(()=>{if(void 0!==import.meta&&import.meta.url)try{return new URL("../..",import.meta.url).href}catch(e){}if("undefined"!=typeof document&&document.baseURI){const e=document.baseURI;return e.endsWith("/")?e:`${e}/`}if("undefined"!=typeof window&&window.location){const e=window.location.href;return e.endsWith("/")?e:e.replace(/[^/]*$/,"")}return"https://example.invalid/"})(),a={IDIOMAS_SOPORTADOS:["es-MX","es","en"],IDIOMA_PREDETERMINADO:"es-MX",obtenerIdioma(){try{const e=localStorage.getItem("idioma-preferido");if(e&&this.IDIOMAS_SOPORTADOS.includes(e))return e;const t=navigator.language||navigator.userLanguage||"";return t.toLowerCase().startsWith("es-mx")?"es-MX":t.toLowerCase().startsWith("es")?"es":t.toLowerCase().startsWith("en")?"en":this.IDIOMA_PREDETERMINADO}catch(e){return console.warn("Error detectando idioma:",e),this.IDIOMA_PREDETERMINADO}},guardarIdioma(e){try{return!!this.IDIOMAS_SOPORTADOS.includes(e)&&(localStorage.setItem("idioma-preferido",e),!0)}catch(e){return console.warn("Error guardando idioma:",e),!1}},"esEspa√±ol"(){return this.obtenerIdioma().startsWith("es")},esMexicano(){return"es-MX"===this.obtenerIdioma()},actualizarCintillo(){const e=document.querySelector(".cintillo-texto");if(!e)return;const t=n.obtener("cintillo.construccion");e.textContent=t,e.setAttribute("data-idioma",this.obtenerIdioma())},inicializar(){const t=this.obtenerIdioma();document.documentElement.setAttribute("lang",t),this.actualizarCintillo(),e.DEBUG_MODE&&(console.log("üåê Idioma detectado:",t),console.log("üá≤üáΩ Es mexicano:",this.esMexicano()))}},n={obtener(e){const t=a.obtenerIdioma(),n=this.textos[e];return n?n[t]||n[t.split("-")[0]]||n["es-MX"]||n.en||e:(console.warn(`Texto no encontrado: ${e}`),e)},textos:{"cintillo.construccion":{"es-MX":"‚ö° SITIO EN DESARROLLO ‚ö° PR√ìXIMAMENTE FUNCIONALIDAD COMPLETA ‚ö°",es:"‚ö° EN CONSTRUCCI√ìN ‚ö° PR√ìXIMAMENTE DISPONIBLE ‚ö°",en:"‚ö° UNDER DEVELOPMENT ‚ö° COMING SOON ‚ö°"},"sistema.cargando":{"es-MX":"Cargando...",es:"Cargando...",en:"Loading..."},"sistema.error":{"es-MX":"Error al cargar",es:"Error al cargar",en:"Loading error"},"sistema.sinResultados":{"es-MX":"No se encontraron resultados",es:"No se encontraron resultados",en:"No results found"},"productos.desde":{"es-MX":"Desde",es:"Desde",en:"From"},"productos.verMas":{"es-MX":"Ver m√°s detalles",es:"Ver m√°s detalles",en:"View more details"},"productos.disponible":{"es-MX":"Disponible",es:"Disponible",en:"Available"},"productos.agotado":{"es-MX":"Agotado",es:"Agotado",en:"Out of stock"},"promos.titulo":{"es-MX":"Promociones Especiales",es:"Promociones Especiales",en:"Special Offers"},"promos.ahorra":{"es-MX":"Ahorra",es:"Ahorra",en:"Save"},"promos.valido":{"es-MX":"V√°lido hasta",es:"V√°lido hasta",en:"Valid until"},"filtros.todos":{"es-MX":"Todos",es:"Todos",en:"All"},"filtros.categoria":{"es-MX":"Categor√≠a",es:"Categor√≠a",en:"Category"},"filtros.limpiar":{"es-MX":"Limpiar filtros",es:"Limpiar filtros",en:"Clear filters"},"contacto.messenger_main":{"es-MX":"Contactar por Messenger",es:"Contactar por Messenger",en:"Contact via Messenger"},"contacto.messenger":{"es-MX":"Enviar mensaje",es:"Enviar mensaje",en:"Send message"},"contacto.cotizar":{"es-MX":"Solicitar cotizaci√≥n",es:"Solicitar cotizaci√≥n",en:"Request quote"},"faq.titulo":{"es-MX":"Preguntas Frecuentes",es:"Preguntas Frecuentes",en:"Frequently Asked Questions"},"faq.ver":{"es-MX":"Ver respuesta",es:"Ver respuesta",en:"View answer"},"error.productos":{"es-MX":"Error al cargar productos. Por favor, intente nuevamente.",es:"Error al cargar productos. Por favor, intente nuevamente.",en:"Error loading products. Please try again."},"error.promos":{"es-MX":"Error al cargar promociones. Por favor, intente nuevamente.",es:"Error al cargar promociones. Por favor, intente nuevamente.",en:"Error loading promotions. Please try again."},"error.faq":{"es-MX":"Error al cargar preguntas frecuentes. Por favor, intente nuevamente.",es:"Error al cargar preguntas frecuentes. Por favor, intente nuevamente.",en:"Error loading FAQs. Please try again."},"error.red":{"es-MX":"Error de conexi√≥n. Verifique su conexi√≥n a internet.",es:"Error de conexi√≥n. Verifique su conexi√≥n a internet.",en:"Connection error. Please check your internet connection."},"debug.iniciado":{"es-MX":"Sistema iniciado correctamente",es:"Sistema iniciado correctamente",en:"System started successfully"},"debug.productosOK":{"es-MX":"Productos cargados",es:"Productos cargados",en:"Products loaded"},"debug.promosOK":{"es-MX":"Promociones cargadas",es:"Promociones cargadas",en:"Promotions loaded"},"debug.faqOK":{"es-MX":"Preguntas frecuentes cargadas",es:"Preguntas frecuentes cargadas",en:"FAQs loaded"}}},o=window.matchMedia("(prefers-reduced-motion: reduce)");let r=null;const s={callbacks:new Set,timeout:null,ticking:!1,DEBOUNCE_MS:150,register(e){this.callbacks.add(e),e()},unregister(e){this.callbacks.delete(e)},handleResize(){this.ticking||(this.ticking=!0,requestAnimationFrame(()=>{clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.callbacks.forEach(e=>{try{e()}catch(e){console.error("Resize callback error:",e)}}),this.ticking=!1},this.DEBOUNCE_MS)}))},init(){window.addEventListener("resize",()=>this.handleResize(),{passive:!0})}};function i(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function c(e,{allowRelative:a=!0}={}){try{const n=String(e||"").trim();if(!n)return"#";if(/^(javascript|data):/i.test(n))return"#";if(a&&(n.startsWith("/")||n.startsWith("./")||n.startsWith("../")||!n.startsWith("//")&&!/^[a-zA-Z][a-zA-Z\d+.-]*:/.test(n)))return new URL(n,t).href;const o=new URL(n,t);if(["http:","https:","mailto:","tel:"].includes(o.protocol))return o.href}catch(e){}return"#"}function l(e,t={}){try{"function"==typeof gtag&&gtag("event",e,t)}catch(e){}}async function d(e){try{const t=c(e);if("#"===t)throw new Error(`Ruta no segura: ${e}`);const a=await fetch(t);if(!a.ok)throw new Error(`${n.obtener("error.red")} (${t})`);return await a.json()}catch(t){return console.error(`‚ùå ${n.obtener("sistema.error")}: ${e}`,t),null}}function u(e){if(!(e&&e instanceof Element))return;if(o.matches)return e.matches("[data-animate]")&&e.classList.add("is-visible"),void e.querySelectorAll("[data-animate]").forEach(e=>e.classList.add("is-visible"));if(!r)return;const t=[];e.matches("[data-animate]")&&!e.classList.contains("is-visible")&&t.push(e),e.querySelectorAll("[data-animate]").forEach(e=>{e.classList.contains("is-visible")||t.push(e)}),t.forEach(e=>r.observe(e))}s.init();let m=[],p=[];async function g(){const t=await d(e.DATA_PATHS.productsBase);t&&(m=t.filter(e=>"activo"===e.estado),p=[...m],h(),function(){const e=document.getElementById("category-filter");if(!e)return;const t=[...new Set(m.map(e=>e.categoria))];e.innerHTML="";const a=document.createElement("option");a.value="todas",a.textContent="Todas",e.appendChild(a),t.forEach(t=>{if(!t)return;const a=document.createElement("option");a.value=String(t),a.textContent=String(t),e.appendChild(a)})}())}function h(){const t=document.getElementById("product-carousel");if(t){if(0===p.length)return t.innerHTML='\n      <div class="card glass placeholder-card" data-animate="fade-up">\n        <img src="assets/img/placeholder-catalog.svg" alt="Sin coincidencias en el cat√°logo" class="placeholder-illustration" width="320" height="240" loading="lazy" decoding="async" />\n        <p>No se encontraron productos con los filtros seleccionados. Ajusta los filtros o cu√©ntanos qu√© est√°s buscando.</p>\n      </div>\n    ',void u(t);t.innerHTML=p.map((t,a)=>{Math.min(a,5);const n=t.imagen&&!t.imagen.startsWith("/")&&!String(t.imagen).includes("."),o=i(t.nombre||""),r=n?`<div class="product-emoji">${i(t.imagen)}</div>`:`<img class="product-image" src="${c(t.imagen||e.PLACEHOLDER_IMAGE)}" alt="${o}" data-placeholder="${e.PLACEHOLDER_IMAGE}" loading="lazy" decoding="async" />`,s=[{label:"Material",value:t.material},{label:"Incluye",value:t.incluye},{label:"Variantes",value:t.variantes}].filter(e=>e.value),d=s.length?`\n        <dl class="product-details">\n          ${s.map(e=>`\n            <div>\n              <dt>${i(e.label)}</dt>\n              <dd>${i(e.value)}</dd>\n            </div>\n          `).join("")}\n        </dl>\n      `:"",u=t.tags&&t.tags.length?`\n        <div class="product-tags">\n          ${t.tags.map(e=>`<span class="tag">${i(e)}</span>`).join("")}\n        </div>\n      `:"",m=t.sugerencias?`<p class="product-suggestions">üí° <strong>Sugerencias:</strong> ${i(t.sugerencias)}</p>`:"";return l("view_item",{item_id:t.id,item_name:t.nombre,price:t.precio_mxn,item_category:t.categoria}),`\n  <article class="card glass product-card animate-delay-${Math.min(a,5)}" role="listitem" data-animate="fade-up">\n      <div class="product-media">\n        ${r}\n      </div>\n      <div class="product-meta">\n        <span class="product-sku">${i(t.id||"")}</span>\n        ${t.categoria?`<span class="product-line">${i(t.categoria)}</span>`:""}\n      </div>\n  <h3 class="product-name">${o}</h3>\n  <p class="product-price">${t.precio_rango_mxn?`$${i(String(t.precio_rango_mxn))} MXN`:`$${i(String(t.precio_mxn))} MXN`}</p>\n  <p class="product-price-note">Rango por personalizaci√≥n, tama√±o/grosor, acabados, herrajes/adhesivos, alcance y tirada.</p>\n      <p class="product-description">${i(t.descripcion||"")}</p>\n      ${d}\n      ${u}\n      ${m}\n      <a href="${function(t){const a=`https://m.me/${e.MESSENGER_PAGE}`;return t?`${a}?ref=${encodeURIComponent(t)}`:a}(`product:${encodeURIComponent(t.id||"")}|${encodeURIComponent(t.nombre)}`)}" \n         class="btn btn-primary product-cta" \n         target="_blank" \n         rel="noopener noreferrer" \n         data-sku="${t.id}" \n         data-name="${i(t.nombre)}">\n        Consultar disponibilidad en Messenger\n      </a>\n    </article>\n  `}).join(""),u(t),function(t){if(!t)return;t.querySelectorAll("img.product-image").forEach(t=>{t.addEventListener("error",function(){const t=this.getAttribute("data-placeholder")||e.PLACEHOLDER_IMAGE;this.src!==t&&(this.src=t)},{once:!0})})}(t),function(e){const t=document.getElementById("catalogo"),a=t?.querySelector("#product-carousel"),n=t?.querySelector(".carousel-btn-prev"),o=t?.querySelector(".carousel-btn-next"),r=document.getElementById("catalog-dots");if(!(a&&n&&o&&r))return;let i=0,c=1;function d(){c=window.innerWidth>=1024?3:window.innerWidth>=768?2:1}function u(){return Math.ceil(e/c)}function m(){const e=100/c*-i;a.style.transform=`translateX(${e}%)`,p(),h()}function p(){const e=u();n.disabled=0===i,o.disabled=i>=e-1}function g(){const e=u();r.innerHTML="";for(let t=0;t<e;t++){const e=document.createElement("button");e.classList.add("carousel-dot"),e.setAttribute("aria-label",`Ir a p√°gina ${t+1}`),t===i&&e.classList.add("active"),e.addEventListener("click",()=>{i=t,m(),l("catalog_carousel_navigation",{method:"dot",index:i})}),r.appendChild(e)}}function h(){r.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===i)})}n.addEventListener("click",()=>{i>0&&(i--,m(),l("catalog_carousel_navigation",{method:"button",direction:"prev",index:i}))}),o.addEventListener("click",()=>{const e=u();i<e-1&&(i++,m(),l("catalog_carousel_navigation",{method:"button",direction:"next",index:i}))});let f=0,v=0;function b(){const e=50,t=f-v;Math.abs(t)>e&&(t>0?o.click():n.click(),l("catalog_carousel_navigation",{method:"swipe",direction:t>0?"next":"prev"}))}a.addEventListener("touchstart",e=>{f=e.changedTouches[0].screenX},{passive:!0}),a.addEventListener("touchend",e=>{v=e.changedTouches[0].screenX,b()},{passive:!0});const E=()=>{const e=c;d(),e!==c&&(i=0,g(),m())};s.register(E),d(),g(),m(),l("catalog_carousel_init",{items:e,itemsPerView:c})}(p.length),t.addEventListener("click",e=>{const t=e.target.closest(".product-cta");t&&l("add_to_cart",{item_id:t.getAttribute("data-sku")||"",item_name:t.getAttribute("data-name")||""})},{once:!0})}}function f(){const e=document.getElementById("category-filter")?.value||"todas",t=document.getElementById("search-input")?.value.toLowerCase()||"";p=m.filter(a=>{const n="todas"===e||a.categoria===e,o=!t||a.nombre.toLowerCase().includes(t)||(a.descripcion||"").toLowerCase().includes(t)||(a.id||"").toLowerCase().includes(t)||a.tags?.some(e=>e.toLowerCase().includes(t));return n&&o}),h()}let v=!1;async function b(){if(v)return;const t=await d(e.DATA_PATHS.promos),a=document.getElementById("promos-container");if(!a)return;v=!0;const n=new Date,o=Array.isArray(t)?t:[],r=e=>String(e||"").toLowerCase(),m=new Set(["inactivo","pausado","desactivado","draft"]),p=o.filter(e=>{const t=r(e.estado||"activo");if(m.has(t))return!1;const a=e.hasta?new Date(e.hasta):null;if(a&&n>a)return!1;const o=e.desde?new Date(e.desde):null;return"programado"!==t&&"pendiente"!==t||(!o||n>=o)}),g=new Set,h=[];p.forEach(e=>{const t=e.id||e.titulo||`promo-${h.length}`,a=String(t).toLowerCase();g.has(a)||(g.add(a),h.push({...e,__resolvedId:t}))});const f={combo:0,stickers:1,fidelidad:2,referidos:3,addon:4},b=e=>{const t=Number(e);return Number.isFinite(t)?t:Number.MAX_SAFE_INTEGER};h.sort((e,t)=>{const a=f[String(e.tipo||"").toLowerCase()]??99,n=f[String(t.tipo||"").toLowerCase()]??99;if(a!==n)return a-n;const o=(t.destacado?1:0)-(e.destacado?1:0);if(0!==o)return o;const r=Math.min(b(e.precio_regular),b(e.precio_especial),b(e.precio_base),b(e.monto_minimo)),s=Math.min(b(t.precio_regular),b(t.precio_especial),b(t.precio_base),b(t.monto_minimo));return r!==s?r-s:String(e.titulo||"").localeCompare(String(t.titulo||""),"es")});const y=h.length,w=document.querySelector("#promos .section-title");if(w&&(y>0?w.innerHTML=`üéØ Promociones activas <span class="promo-count">(${y})</span>`:w.textContent="üéØ Promociones activas"),0===y)return void l("promos_empty",{reason:"no_active_promos"});const M=e=>{const t=Number(e);return Number.isFinite(t)?t%1==0?`$${t}`:`$${t.toFixed(2)}`:null},$=h.map((e,t)=>{const a=70*Math.min(t,5),o=e.destacado?"promo-destacado":"",s=e.animacion?`promo-anim-${e.animacion}`:"",l=e.tipo?String(e.tipo):"general",d=i(String(e.__resolvedId||e.id||`promo-${t}`)),u=r(e.estado||"activo"),m=e.desde?new Date(e.desde):null,p=e.hasta?new Date(e.hasta):null,g=Boolean(m&&m>n);let h="";const f=M(e.precio_regular??e.precio_base),v=Number.isFinite(Number(e.precio_unitario))?`<span class="promo-unitario">$${Number(e.precio_unitario).toFixed(2)} c/u</span>`:"";if(f)h=`\n        <div class="promo-precio">\n          <span class="promo-precio-total">${f}</span>\n          ${v}\n        </div>\n      `;else{const t=M(e.precio_especial),a=M(e.monto_minimo);t?h=`\n        <div class="promo-precio">\n          <span class="promo-precio-especial">${t}</span>\n        </div>\n      `:a&&(h=`\n        <div class="promo-minimo">\n          <span>M√≠nimo: ${a}</span>\n        </div>\n      `)}const b=e.badge?`<span class="promo-badge">${i(e.badge)}</span>`:"",y=e.beneficios&&e.beneficios.length>0?`<ul class="promo-beneficios">${e.beneficios.map(e=>`<li>‚úì ${i(e)}</li>`).join("")}</ul>`:"";let w="";"permanente"===(e.tipo||"").toLowerCase()?w='<p class="promo-validez">‚è∞ Promoci√≥n permanente</p>':g&&m&&p?w=`<p class="promo-validez">üöÄ Disponible ${i(E(e.desde))} ‚Äì ${i(E(e.hasta))}</p>`:g&&m?w=`<p class="promo-validez">üöÄ Disponible desde ${i(E(e.desde))}</p>`:m&&p?w=`<p class="promo-validez">üìÖ V√°lido ${i(E(e.desde))} ‚Äì ${i(E(e.hasta))}</p>`:p?w=`<p class="promo-validez">‚è∞ Vigente hasta ${i(E(e.hasta))}</p>`:m&&(w=`<p class="promo-validez">üìÖ Vigente desde ${i(E(e.desde))}</p>`);const $=i(e.titulo||"Promoci√≥n"),L=e.cta_url?`<a href="${c(e.cta_url)}" class="btn btn-primary promo-cta" target="_blank" rel="noopener noreferrer" data-promo-id="${d}" data-promo-name="${$}">${i(e.cta_text||"M√°s info")}</a>`:`<button class="btn btn-primary promo-cta-contact" data-promo-id="${d}" data-promo-name="${$}">${i("Consultar por Messenger")}</button>`;let A="";if("string"==typeof e.icono&&e.icono.trim()){const t=e.icono.trim();if(/\.svg(\?|$)/i.test(t)){const e=c(t);A=e&&"#"!==e?`<img src="${e}" alt="${$}" class="promo-icon" width="200" height="200" loading="lazy" decoding="async" data-promo-id="${d}" data-icon-src="${i(e)}" />`:'<span class="promo-emoji" aria-hidden="true">üéÅ</span>'}else A=`<span class="promo-emoji" aria-hidden="true">${i(t)}</span>`}else A='<span class="promo-emoji" aria-hidden="true">üéÅ</span>';return`<article class="card glass promo-card ${o} ${s} ${g?"promo-upcoming":""} animate-delay-${a}" data-animate="fade-up" data-promo-id="${d}" data-promo-tipo="${i(l)}" data-promo-state="${i(u)}" data-promo-upcoming="${g}">${b?`<div class="promo-badge-wrapper">${b}</div>`:""}<div class="promo-icono-container">${A}</div><h3 class="promo-titulo">${$}</h3><p class="promo-subtitulo">${i(e.subtitulo||e.descripcion||"")}</p>${h}${y}${w}${L}</article>`});a.innerHTML=$.join(""),function(e){if(!e)return;const t=Array.from(e.querySelectorAll("img.promo-icon"));if(0===t.length)return void(e.dataset.iconsReady="true");let a=t.length;const n=()=>{a-=1,a<=0&&(e.dataset.iconsReady="true")};t.forEach(e=>{const t=()=>{if(!e.isConnected)return void n();const t=document.createElement("span");t.className="promo-emoji",t.setAttribute("aria-hidden","true"),t.textContent="üéÅ",t.dataset.iconStatus="fallback",t.dataset.promoId=e.getAttribute("data-promo-id")||"";const a=e.parentElement;a?a.replaceChild(t,e):e.replaceWith(t),l("promo_icon_missing",{promotion_id:t.dataset.promoId||"",src:e.getAttribute("data-icon-src")||e.currentSrc||e.src||""}),n()},a=()=>{e.dataset.iconStatus="loaded",n()};e.complete?e.naturalWidth>0?a():t():(e.addEventListener("load",a,{once:!0}),e.addEventListener("error",t,{once:!0}))})}(a),u(a),function(e,t){if(!e)return;const a=e.closest(".carousel-container"),n=a?.closest("section"),o=a?.querySelector(".carousel-btn-prev"),r=a?.querySelector(".carousel-btn-next"),i=n?.querySelector("#promos-dots");if(!(a&&o&&r&&i))return;if(0===Array.from(e.children).length)return;let c=0,d=1;const u=()=>window.innerWidth>=1024?3:window.innerWidth>=768?2:1,m=()=>Math.max(1,Math.ceil(t/Math.max(d,1))),p=e=>{const t=Math.max(0,m()-1);return Math.min(Math.max(0,e),t)},g=()=>{const e=m(),t=Math.max(0,e-1),a=e<=1;o.disabled=a||c<=0,r.disabled=a||c>=t},h=()=>{i.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===c)})},f=()=>{const t=-c*(100/Math.max(d,1));e.style.transform=`translateX(${t}%)`,g(),h()},v=()=>{const e=m();if(i.innerHTML="",e<=1)i.setAttribute("hidden","");else{i.removeAttribute("hidden");for(let t=0;t<e;t+=1){const a=document.createElement("button");a.type="button",a.classList.add("carousel-dot"),a.setAttribute("aria-label",`Ir a la p√°gina ${t+1}`),t===c&&a.classList.add("active"),a.addEventListener("click",()=>{c=p(t),f(),l("promo_carousel_navigation",{method:"dot",page:c+1,total_pages:e})}),i.appendChild(a)}}};o.addEventListener("click",()=>{const e=p(c-1);e!==c&&(c=e,f(),l("promo_carousel_navigation",{method:"arrow",direction:"prev",page:c+1,total_pages:m()}))}),r.addEventListener("click",()=>{const e=p(c+1);e!==c&&(c=e,f(),l("promo_carousel_navigation",{method:"arrow",direction:"next",page:c+1,total_pages:m()}))});let b=0,E=0;function y(){const e=50,t=b-E;Math.abs(t)>e&&(t>0?r.click():o.click())}e.addEventListener("touchstart",e=>{b=e.changedTouches[0].screenX},{passive:!0}),e.addEventListener("touchend",e=>{E=e.changedTouches[0].screenX,y()},{passive:!0});const w=()=>{const e=d;if(d=u(),e!==d){const a=Math.min(c*e,t-1);c=p(Math.floor(a/Math.max(d,1))),v()}else c=p(c);f()};s.register(w),d=u(),v(),f()}(a,y),a.addEventListener("click",e=>{const t=e.target.closest(".promo-cta");t&&l("select_promotion",{promotion_id:t.getAttribute("data-promo-id")||"",promotion_name:t.getAttribute("data-promo-name")||""})}),a.addEventListener("click",t=>{const a=t.target.closest(".promo-cta-contact");if(!a)return;const n=a.getAttribute("data-promo-name")||"Promoci√≥n";window.open(`https://m.me/${e.MESSENGER_PAGE}`,"_blank","noopener"),l("contact_promo",{promotion_id:a.getAttribute("data-promo-id")||"",promotion_name:n,platform:"messenger"})})}function E(e){return new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}let y=!1;async function w(){if(y)return;const t=await d(e.DATA_PATHS.faq),a=document.getElementById("faq-list");if(!a)return;if(y=!0,!t||0===t.length)return a.innerHTML='\n      <div class="card glass placeholder-card" data-animate="fade-up">\n        <img src="assets/img/placeholder-faq.svg" alt="Preguntas frecuentes en preparaci√≥n" class="placeholder-illustration" width="320" height="240" loading="lazy" decoding="async" />\n        <p>A√∫n estamos documentando las preguntas frecuentes. Escr√≠benos por Messenger y resolvemos tu caso.</p>\n      </div>\n    ',void u(a);a.innerHTML=t.map((e,t)=>{Math.min(t,5);const a=`faq-${M(e.q)}`;return`\n  <details class="faq-item animate-delay-${Math.min(t,5)}" id="${a}" data-animate="fade-up">\n      <summary><span>${i(e.q)}</span></summary>\n      <p>${i(e.a)}</p>\n    </details>\n  `}).join(""),u(a);const n=document.getElementById("faq-top");if(n){const e=t.filter(e=>e.destacada);e.length>0&&(n.innerHTML=e.map(e=>{const t=`faq-${M(e.q)}`;return`<a class="faq-chip" href="#${t}" data-faq-target="#${t}" aria-label="Ir a: ${i(e.q)}">‚≠ê ${i(e.q)}</a>`}).join(""),n.addEventListener("click",e=>{const t=e.target.closest("a.faq-chip");if(!t)return;const a=t.getAttribute("data-faq-target");if(!a)return;const n=document.querySelector(a);n&&n.classList.contains("faq-item")&&(n.open=!0,n.scrollIntoView({behavior:"smooth",block:"start"})),e.preventDefault()}))}const o=document.getElementById("faq-search"),r=document.getElementById("faq-category"),s=document.getElementById("faq-expand"),c=document.getElementById("faq-collapse"),l=document.getElementById("faq-count"),m=Array.from(a.querySelectorAll(".faq-item"));if(r){Array.from(new Set(t.map(e=>e.categoria).filter(Boolean))).sort().forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),r.appendChild(t)})}function p(e){const t=(e||"").trim().toLowerCase(),a=r&&r.value?r.value:"";let n=0;if(m.forEach(e=>{const o=e.textContent.toLowerCase(),r=0===t.length||o.includes(t),s=!a||o.includes(a)||e.querySelector("summary span")?.textContent.toLowerCase().includes(a),i=r&&s;e.style.display=i?"":"none",i&&n++}),l){const e=m.length;l.textContent=`Mostrando ${n} de ${e} preguntas`}}if(o&&o.addEventListener("input",e=>p(e.target.value)),r&&r.addEventListener("change",()=>p(o?o.value:"")),s&&s.addEventListener("click",()=>m.forEach(e=>e.open=!0)),c&&c.addEventListener("click",()=>m.forEach(e=>e.open=!1)),l&&(l.textContent=`Mostrando ${m.length} de ${m.length} preguntas`),location.hash&&location.hash.startsWith("#faq-")){const e=document.querySelector(location.hash);e&&e.classList.contains("faq-item")&&(e.open=!0,e.scrollIntoView({behavior:"smooth",block:"start"}))}try{!function(e){if(!Array.isArray(e)||0===e.length)return;const t={"@context":"https://schema.org","@type":"FAQPage",mainEntity:e.map(e=>({"@type":"Question",name:e.q,acceptedAnswer:{"@type":"Answer",text:e.a}}))},a=JSON.stringify(t);let n=document.getElementById("faq-schema");n||(n=document.createElement("script"),n.type="application/ld+json",n.id="faq-schema",document.head.appendChild(n));n.textContent=a}(t)}catch(e){console.warn("FAQ schema injection skipped:",e)}}function M(e){return String(e).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}async function $(){let t=null;const a=await d(e.DATA_PATHS.brand);if(t=a&&a.social?a.social:await d(e.DATA_PATHS.social),!t)return;const n=document.getElementById("social-links");if(n){const e=[];t.instagram&&e.push({key:"instagram",label:"Instagram",url:t.instagram}),t.facebook&&e.push({key:"facebook",label:"Facebook",url:t.facebook}),t.tiktok&&e.push({key:"tiktok",label:"TikTok",url:t.tiktok}),n.innerHTML=e.map(e=>`\n      <a class="social-icon social-icon--${e.key}" href="${c(e.url)}" target="_blank" rel="noopener noreferrer" aria-label="${i(e.label)}" title="${i(e.label)}">\n        ${L(e.key)}\n        <span class="sr-only">${i(e.label)}</span>\n      </a>\n    `).join("")}const o=document.getElementById("hero-social-links");if(o){const e=[];t.instagram&&e.push({key:"instagram",label:"Instagram",url:t.instagram,icon:"instagram"}),t.facebook&&e.push({key:"facebook",label:"Facebook",url:t.facebook,icon:"facebook"}),t.tiktok&&e.push({key:"tiktok",label:"TikTok",url:t.tiktok,icon:"tiktok"}),o.innerHTML=e.map(e=>`\n      <a class="community-link" href="${c(e.url)}" target="_blank" rel="noopener noreferrer" aria-label="${i(e.label)}">\n        ${L(e.key)}\n        <span>${i(e.label)}</span>\n      </a>\n    `).join("")}}function L(e){const t={instagram:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>',facebook:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',tiktok:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>',youtube:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>',twitter:'<svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>'};return t[e]||t.instagram}function A(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav-menu"),a=document.querySelector(".header");if(!e||!t)return;const n=t.classList.contains("active");e.setAttribute("aria-expanded",String(n)),e.setAttribute("aria-label",n?"Cerrar men√∫":"Abrir men√∫");let o=!1;const r=()=>{o||(o=!0,t.classList.remove("active"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Abrir men√∫"),document.body.classList.remove("nav-open"),setTimeout(()=>{o=!1},350))};e.addEventListener("click",a=>{if(a.preventDefault(),a.stopPropagation(),o)return;const n=t.classList.contains("active");n?r():o||(o=!0,t.classList.add("active"),e.classList.add("active"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Cerrar men√∫"),document.body.classList.add("nav-open"),setTimeout(()=>{o=!1},350)),l("nav_menu_toggle",{state:n?"closed":"open"})}),t.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{r(),l("nav_link_click",{href:e.getAttribute("href")})})}),document.addEventListener("click",a=>{!t.classList.contains("active")||t.contains(a.target)||e.contains(a.target)||(r(),l("nav_menu_close",{method:"outside_click"}))}),document.addEventListener("keydown",a=>{"Escape"===a.key&&t.classList.contains("active")&&(r(),e.focus(),l("nav_menu_close",{method:"escape_key"}))});s.register(()=>{window.innerWidth>=768&&t.classList.contains("active")&&(r(),l("nav_menu_close",{method:"resize_to_desktop"}))}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t||!t)return;e.preventDefault();const n=document.querySelector(t);if(n){const e=a?a.offsetHeight:80,t=n.offsetTop-e;window.scrollTo({top:t,behavior:"smooth"})}})})}async function _(){a.inicializar(),function(){const e=document.documentElement,t=()=>{const t=.01*window.innerHeight;e.style.setProperty("--vh",`${t}px`)},a=()=>{const t=.01*window.innerWidth;e.style.setProperty("--vw",`${t}px`)},n=()=>{const t=document.querySelector(".header");t&&e.style.setProperty("--header-h",`${t.offsetHeight}px`)},o=()=>{try{const t=navigator.deviceMemory||2,a=navigator.hardwareConcurrency||2,n=window.matchMedia("(prefers-reduced-motion: reduce)").matches,o=window.matchMedia("(pointer: fine)").matches,r=t>=4&&a>=6&&!n&&o;e.classList.toggle("device-high",r),e.classList.toggle("device-low",!r)}catch(t){e.classList.add("device-low")}};t(),n(),a(),o(),window.addEventListener("resize",()=>{t(),n(),a()},{passive:!0}),window.addEventListener("orientationchange",()=>{t(),n(),a()})}(),function(){try{void 0===window.gtag&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer&&window.dataLayer.push(arguments)}),gtag("js",new Date),gtag("config","G-Y46M6J1EWS",{send_page_view:!0,anonymize_ip:!0})}catch(e){}}(),A(),function(){const e=document.getElementById("category-filter"),t=document.getElementById("search-input");e&&e.addEventListener("change",f),t&&t.addEventListener("input",f)}(),function(){const e=document.querySelector(".header");if(!e)return;let t=!1,a=0,n="up";const o=()=>{const o=window.scrollY,r=o-a;Math.abs(r)>5&&(n=r>0?"down":"up"),e.classList.toggle("is-scrolled",o>24),window.innerWidth<1024?e.classList.toggle("is-compact",o>300):e.classList.remove("is-compact");const s=document.body.classList.contains("nav-open"),i=o<100;"down"===n&&o>100&&!s?e.classList.add("is-hidden"):("up"===n||i||s)&&e.classList.remove("is-hidden"),a=o,t=!1};o(),window.addEventListener("scroll",()=>{t||(requestAnimationFrame(o),t=!0)},{passive:!0})}(),function(){const e=document.querySelectorAll("[data-animate]");e.length&&(o.matches?e.forEach(e=>e.classList.add("is-visible")):(r=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(setTimeout(()=>{e.target.classList.add("is-visible")},50),t.unobserve(e.target))})},{threshold:.15,rootMargin:"0px 0px -8% 0px"}),e.forEach(e=>r.observe(e))))}(),document.querySelectorAll(".email-link[data-email-user][data-email-domain]").forEach(e=>{const t=e.getAttribute("data-email-user"),a=e.getAttribute("data-email-domain");if(!t||!a)return;const n=`${t}@${a}`;e.setAttribute("href",`mailto:${n}`);const o=e.getAttribute("data-email-label");e.textContent.trim()&&!o||(e.textContent=o||n),e.setAttribute("rel",`${e.getAttribute("rel")||""} nofollow noopener noreferrer`)}),function(){try{const e={"@context":"https://schema.org","@type":"Organization",name:"Mahitek 3D Lab",url:"https://dtcsrni.github.io/Mahitek_3D_Lab_MX/",logo:"https://dtcsrni.github.io/Mahitek_3D_Lab_MX/assets/img/mark-icon.svg",sameAs:["https://www.instagram.com/mahitek3dlab","https://www.facebook.com/mahitek3dlab"],description:"Laboratorio de impresi√≥n 3D en PETG desde Pachuca, M√©xico. Creamos piezas personalizadas para regalos, decoraci√≥n y proyectos creativos.",address:{"@type":"PostalAddress",addressLocality:"Pachuca",addressRegion:"Hidalgo",addressCountry:"MX"},contactPoint:{"@type":"ContactPoint",contactType:"Customer Support",email:"armsystechno@gmail.com",url:"https://m.me/mahitek3dlabmx"}},t=document.createElement("script");t.type="application/ld+json",t.id="org-schema",t.textContent=JSON.stringify(e),document.head.appendChild(t)}catch(e){}}(),await Promise.all([g(),$()]),function(){if("undefined"==typeof IntersectionObserver)return v||b(),void(y||w());const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=t.target,n=a.id;"promos"!==n||v?"faq"!==n||y||(w(),e.unobserve(a)):(b(),e.unobserve(a))}})},{rootMargin:"200px"}),t=document.getElementById("promos"),a=document.getElementById("faq");t&&e.observe(t),a&&e.observe(a)}(),function(){const e=new URLSearchParams(location.search),t=e.get("m"),a=e.get("q"),n=e.get("p"),o=document.getElementById("category-filter"),r=document.getElementById("search-input");let s=!1;t&&o&&(o.value=t,s=!0);a&&r&&(r.value=a,s=!0);s&&f();if(n){const e=[...document.querySelectorAll(".product-card")].find(e=>e.querySelector(".product-sku")?.textContent.includes(n));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.outline="2px solid rgba(6, 182, 212, 0.7)",setTimeout(()=>{e.style.outline="none"},2e3))}const i=()=>{const e=new URLSearchParams(location.search),t=o?.value&&"todas"!==o.value?o.value:"",a=r?.value?.trim()||"";t?e.set("m",t):e.delete("m"),a?e.set("q",a):e.delete("q"),history.replaceState(null,"",`${location.pathname}${e.toString()?`?${e}`:""}`)};o&&o.addEventListener("change",i);r&&r.addEventListener("input",i)}(),e.DEBUG_MODE&&(console.log(`‚úÖ ${n.obtener("debug.iniciado")}`),console.log(`üìä ${n.obtener("debug.productosOK")}: ${m.length}`),console.log(`üí∞ Margen de precio: ${e.PRICE_MARKUP} (${100*(e.PRICE_MARKUP-1)}%)`),console.log(`üîÑ Redondeo: $${e.PRICE_STEP} MXN`))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",_):_(),window.MahitekLab={config:e,calculateSalePrice:function(t,a=e.PRICE_MARKUP,n=e.PRICE_STEP){const o=t*a;return Math.round(o/n)*n},products:()=>m,filterProducts:f};