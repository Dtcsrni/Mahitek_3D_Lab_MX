{
  "version": 3,
  "sources": ["../../../src/index.js", "file:///C:/Users/evega/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "file:///C:/Users/evega/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-A0EsGD/middleware-insertion-facade.js", "file:///C:/Users/evega/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/common.ts", "../bundle-A0EsGD/middleware-loader.entry.ts"],
  "sourceRoot": "V:\\Proyectos_Impresion3D\\Landing Page Oficial Mahitek MX\\Mahitek_3D_Lab_MX\\Mahitek_3D_Lab_MX\\workers\\mahiteklab-api\\.wrangler\\tmp\\dev-WBRGAO",
  "sourcesContent": ["function json(data, init = {}) {\n  const headers = new Headers(init.headers || {});\n  headers.set('content-type', 'application/json; charset=utf-8');\n  return new Response(JSON.stringify(data), { ...init, headers });\n}\n\nconst BIENVENIDA_CAMPAIGN_ID = 'BIENVENIDA';\n\nfunction getAllowedOrigins(env) {\n  const raw = String(env.ALLOWED_ORIGINS || '').trim();\n  return raw\n    .split(',')\n    .map((s) => s.trim())\n    .filter(Boolean);\n}\n\nfunction corsify(request, response, env) {\n  const origin = request.headers.get('Origin') || '';\n  const allowed = getAllowedOrigins(env);\n  if (!origin || !allowed.includes(origin)) return response;\n\n  const headers = new Headers(response.headers);\n  headers.set('Access-Control-Allow-Origin', origin);\n  headers.set('Vary', 'Origin');\n  headers.set('Access-Control-Allow-Credentials', 'false');\n  headers.set('Access-Control-Allow-Headers', 'content-type, authorization, x-admin-role');\n  headers.set('Access-Control-Allow-Methods', 'GET,POST,OPTIONS');\n  return new Response(response.body, {\n    status: response.status,\n    statusText: response.statusText,\n    headers\n  });\n}\n\nfunction isEmail(value) {\n  const s = String(value || '').trim();\n  if (s.length < 6 || s.length > 320) return false;\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(s);\n}\n\nfunction nowIso() {\n  return new Date().toISOString();\n}\n\nasync function hmacSha256Hex(secret, message) {\n  const enc = new TextEncoder();\n  const key = await crypto.subtle.importKey(\n    'raw',\n    enc.encode(secret),\n    { name: 'HMAC', hash: 'SHA-256' },\n    false,\n    ['sign'],\n  );\n  const sig = await crypto.subtle.sign('HMAC', key, enc.encode(message));\n  return [...new Uint8Array(sig)].map((b) => b.toString(16).padStart(2, '0')).join('');\n}\n\nfunction toCouponCode(prefix, hex) {\n  const core = hex.slice(0, 10).toUpperCase();\n  return `${prefix}-${core}`;\n}\n\nfunction getIp(request) {\n  return (\n    request.headers.get('CF-Connecting-IP') ||\n    request.headers.get('X-Forwarded-For') ||\n    ''\n  ).split(',')[0].trim();\n}\n\nasync function dbEnsure(env) {\n  if (!env.DB) throw new Error('DB binding missing (D1)');\n  return env.DB;\n}\n\nasync function dbExec(db, sql, params = []) {\n  return db.prepare(sql).bind(...params).run();\n}\n\nasync function dbFirst(db, sql, params = []) {\n  const res = await db.prepare(sql).bind(...params).all();\n  return res.results && res.results.length ? res.results[0] : null;\n}\n\nasync function recordEvent(db, { type, email = null, campaignId = null, ip = null, payload = null }) {\n  await dbExec(\n    db,\n    'INSERT INTO events (type, email, campaign_id, ip, created_at, payload_json) VALUES (?, ?, ?, ?, ?, ?)',\n    [type, email, campaignId, ip, nowIso(), payload ? JSON.stringify(payload) : null],\n  );\n}\n\nfunction getCampaignIdFromRequest(body) {\n  const candidate = String(body.campaignId || '').trim();\n  if (!candidate) return null;\n  // IDs simples para evitar inyeccion/ruido\n  if (!/^[A-Z0-9_-]{2,32}$/i.test(candidate)) return null;\n  return candidate;\n}\n\nasync function getActiveCampaign(db, id) {\n  if (!id) return null;\n  const row = await dbFirst(\n    db,\n    `\n      SELECT *\n      FROM campaigns\n      WHERE id = ?\n        AND active = 1\n        AND (starts_at IS NULL OR starts_at <= datetime('now'))\n        AND (ends_at IS NULL OR ends_at >= datetime('now'))\n      LIMIT 1\n    `,\n    [id],\n  );\n  return row;\n}\n\nasync function getWelcomeCampaign(db) {\n  const row = await dbFirst(\n    db,\n    'SELECT * FROM campaigns WHERE id = ? LIMIT 1',\n    [BIENVENIDA_CAMPAIGN_ID],\n  );\n  return row;\n}\n\nasync function upsertSubscriber(db, request, email, body) {\n  const ip = getIp(request);\n  const ua = request.headers.get('User-Agent') || '';\n  const cf = request.cf || {};\n  const referrer = String(body.referrer || request.headers.get('Referer') || '').slice(0, 500);\n  const landingPath = String(body.landingPath || '').slice(0, 200);\n  const source = String(body.source || '').slice(0, 64);\n\n  await dbExec(\n    db,\n    `\n      INSERT INTO subscribers (email, created_at, source, referrer, landing_path, country, region, city, user_agent)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n      ON CONFLICT(email) DO UPDATE SET\n        source = COALESCE(excluded.source, subscribers.source),\n        referrer = COALESCE(excluded.referrer, subscribers.referrer),\n        landing_path = COALESCE(excluded.landing_path, subscribers.landing_path),\n        country = COALESCE(excluded.country, subscribers.country),\n        region = COALESCE(excluded.region, subscribers.region),\n        city = COALESCE(excluded.city, subscribers.city),\n        user_agent = COALESCE(excluded.user_agent, subscribers.user_agent)\n    `,\n    [\n      email,\n      nowIso(),\n      source || null,\n      referrer || null,\n      landingPath || null,\n      cf.country || null,\n      cf.region || null,\n      cf.city || null,\n      ua || null,\n    ],\n  );\n\n  return { ip, ua };\n}\n\nasync function issueCoupon(db, env, { email, campaign }) {\n  const secret = String(env.COUPON_SECRET || '').trim();\n  if (!secret) throw new Error('Missing COUPON_SECRET');\n\n  const msg = `${email}|${campaign.id}`;\n  const hex = await hmacSha256Hex(secret, msg);\n  const code = toCouponCode(campaign.prefix, hex);\n\n  await dbExec(\n    db,\n    'INSERT OR IGNORE INTO coupons (code, email, campaign_id, created_at) VALUES (?, ?, ?, ?)',\n    [code, email, campaign.id, nowIso()],\n  );\n\n  const row = await dbFirst(\n    db,\n    'SELECT code, campaign_id AS campaignId, created_at AS createdAt, redeemed_at AS redeemedAt FROM coupons WHERE email = ? AND campaign_id = ? LIMIT 1',\n    [email, campaign.id],\n  );\n\n  return row;\n}\n\nasync function verifyTurnstile(env, token, ip) {\n  const secret = String(env.TURNSTILE_SECRET || '').trim();\n  if (!secret) {\n    // Modo sin Turnstile (dev/MVP). Recomendado configurar el secret en producci\u00F3n.\n    return { ok: true, skipped: true };\n  }\n  if (!token) return { ok: false, error: 'missing_turnstile_token' };\n\n  const form = new FormData();\n  form.set('secret', secret);\n  form.set('response', token);\n  if (ip) form.set('remoteip', ip);\n\n  const res = await fetch('https://challenges.cloudflare.com/turnstile/v0/siteverify', {\n    method: 'POST',\n    body: form,\n  });\n  const data = await res.json().catch(() => ({}));\n  if (data && data.success) return { ok: true, data };\n  return { ok: false, error: 'turnstile_failed', data };\n}\n\nasync function sendEmail(env, { to, subject, html }) {\n  const provider = String(env.EMAIL_PROVIDER || '').trim().toLowerCase();\n  if (!provider) return { ok: false, error: 'missing_email_provider' };\n\n  if (provider === 'brevo') {\n    const apiKey = String(env.BREVO_API_KEY || '').trim();\n    const fromEmail = String(env.EMAIL_FROM || '').trim();\n    const fromName = String(env.EMAIL_FROM_NAME || 'Mahitek 3D Lab').trim();\n    if (!apiKey || !fromEmail) return { ok: false, error: 'missing_brevo_config' };\n\n    const res = await fetch('https://api.brevo.com/v3/smtp/email', {\n      method: 'POST',\n      headers: {\n        'content-type': 'application/json',\n        'api-key': apiKey,\n      },\n      body: JSON.stringify({\n        sender: { name: fromName, email: fromEmail },\n        to: [{ email: to }],\n        subject,\n        htmlContent: html,\n      }),\n    });\n    if (res.ok) return { ok: true };\n    const text = await res.text().catch(() => '');\n    return { ok: false, error: 'brevo_send_failed', details: text.slice(0, 800) };\n  }\n\n  if (provider === 'resend') {\n    const apiKey = String(env.RESEND_API_KEY || '').trim();\n    const from = String(env.EMAIL_FROM || '').trim();\n    if (!apiKey || !from) return { ok: false, error: 'missing_resend_config' };\n\n    const res = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'content-type': 'application/json',\n        authorization: `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({ from, to: [to], subject, html }),\n    });\n    if (res.ok) return { ok: true };\n    const text = await res.text().catch(() => '');\n    return { ok: false, error: 'resend_send_failed', details: text.slice(0, 800) };\n  }\n\n  return { ok: false, error: `unsupported_email_provider:${provider}` };\n}\n\nfunction renderCouponEmail({ landingUrl, welcome, campaign }) {\n  const brand = {\n    teal: '#0ea5a3',\n    tealDeep: '#0b6b6a',\n    blue: '#1d9bf0',\n    red: '#ef4444',\n    ink: '#0b0f12',\n    inkSoft: '#111827',\n    text: '#e5e7eb',\n    muted: '#a7b0c2',\n    panel: '#0f172a',\n    panelSoft: '#111827',\n    line: '#1f2937',\n  };\n\n  const title = campaign\n    ? 'Tus cupones de bienvenida y campana estan listos'\n    : 'Tu cupon de bienvenida esta listo';\n  const subtitle = campaign\n    ? 'Gracias por registrarte. Usa tu bienvenida y aprovecha el extra de campana.'\n    : 'Gracias por registrarte. Aqui tienes tu beneficio de bienvenida.';\n  const preheader = campaign\n    ? 'Tus cupones de bienvenida y campana estan listos.'\n    : 'Bienvenida a Mahitek 3D Lab. Tu cupon ya esta listo.';\n\n  const couponBlock = (label, code, accent) => `\n    <div class=\"mail-coupon mail-anim\" style=\"background:${brand.panel};border:1px solid ${accent};border-radius:16px;padding:18px;margin:14px 0;\">\n      <div style=\"font-size:12px;letter-spacing:0.18em;text-transform:uppercase;color:${brand.muted};margin-bottom:6px;\">\n        ${label}\n      </div>\n      <div style=\"font-size:22px;font-weight:700;color:#ffffff;letter-spacing:0.1em;\">\n        ${code}\n      </div>\n    </div>\n  `;\n\n  const stackNote = campaign\n    ? `<div style=\"font-size:13px;color:${brand.muted};margin-top:8px;\">\n         Puedes combinar <strong>Bienvenida + campana</strong> en la misma compra (max. 2 cupones).\n       </div>`\n    : '';\n\n  const button = landingUrl\n    ? `<a class=\"mail-btn mail-anim\" href=\"${landingUrl}\" style=\"display:inline-block;background:${brand.blue};color:#ffffff;text-decoration:none;font-weight:600;padding:12px 18px;border-radius:12px;\">\n         Ir al sitio\n       </a>`\n    : '';\n\n  return `<!doctype html>\n  <html lang=\"es\">\n    <head>\n      <meta charset=\"utf-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n      <title>Mahitek 3D Lab</title>\n      <style>\n        @media (prefers-reduced-motion: reduce) {\n          .mail-anim { animation: none !important; }\n        }\n        @keyframes mailFloat {\n          0% { transform: translateY(0); }\n          50% { transform: translateY(-4px); }\n          100% { transform: translateY(0); }\n        }\n        @keyframes mailPulse {\n          0%, 100% { box-shadow: 0 0 0 rgba(14, 165, 163, 0); }\n          50% { box-shadow: 0 0 18px rgba(14, 165, 163, 0.35); }\n        }\n        @keyframes mailCTA {\n          0%, 100% { box-shadow: 0 0 0 rgba(29, 155, 240, 0); }\n          50% { box-shadow: 0 0 16px rgba(29, 155, 240, 0.45); }\n        }\n        .mail-hero { animation: mailFloat 7s ease-in-out infinite; }\n        .mail-coupon { animation: mailPulse 5s ease-in-out infinite; }\n        .mail-btn { animation: mailCTA 4s ease-in-out infinite; }\n      </style>\n    </head>\n    <body style=\"margin:0;background:${brand.ink};font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;line-height:1.6;\">\n      <div style=\"max-width:640px;margin:0 auto;padding:28px 18px 36px;\">\n        <div style=\"display:none;max-height:0;overflow:hidden;opacity:0;color:transparent;\">\n          ${preheader}\n        </div>\n\n        <div class=\"mail-hero mail-anim\" style=\"background:linear-gradient(135deg,${brand.teal},${brand.tealDeep});border-radius:20px;padding:22px 24px;color:#ffffff;border:1px solid ${brand.line};\">\n          <div style=\"font-size:12px;letter-spacing:0.24em;text-transform:uppercase;opacity:0.85;\">Mahitek 3D Lab</div>\n          <h1 style=\"margin:10px 0 6px;font-size:24px;font-weight:700;\">${title}</h1>\n          <p style=\"margin:0;color:#d0f3f2;\">${subtitle}</p>\n        </div>\n\n        <div class=\"mail-anim\" style=\"background:${brand.panelSoft};border-radius:20px;padding:22px;margin-top:18px;color:${brand.text};border:1px solid ${brand.line};\">\n          <p style=\"margin:0 0 12px;font-size:16px;\">\n            Gracias por tu registro. Aqui tienes tus codigos listos para usar:\n          </p>\n          ${couponBlock('Cupon de bienvenida', welcome.code, brand.teal)}\n          ${campaign ? couponBlock('Cupon de campana', campaign.code, brand.red) : ''}\n          ${stackNote}\n\n          <div style=\"margin-top:16px;padding:14px 16px;border-radius:14px;background:${brand.panel};border:1px solid ${brand.line};\">\n            <div style=\"font-size:12px;letter-spacing:0.18em;text-transform:uppercase;color:${brand.muted};margin-bottom:8px;\">\n              Como usar tu cupon\n            </div>\n            <ol style=\"margin:0;padding-left:18px;color:${brand.text};font-size:14px;\">\n              <li>Aplica el codigo al finalizar tu pedido.</li>\n              <li>Si tienes dos cupones, puedes combinarlos en la misma compra.</li>\n              <li>Guarda este correo para tenerlo a la mano.</li>\n            </ol>\n          </div>\n\n          <div style=\"margin-top:18px;\">\n            ${button}\n          </div>\n        </div>\n\n        <div style=\"margin-top:16px;color:${brand.muted};font-size:12px;\">\n          Si no solicitaste este correo, puedes ignorarlo con tranquilidad.\n        </div>\n      </div>\n    </body>\n  </html>`;\n}\nfunction parseAdminTokens(env) {\n  try {\n    const raw = String(env.ADMIN_ROLE_TOKENS_JSON || '').trim();\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return parsed && typeof parsed === 'object' ? parsed : {};\n  } catch {\n    return {};\n  }\n}\n\nfunction requireAdmin(request, env) {\n  const auth = request.headers.get('Authorization') || '';\n  const m = auth.match(/^Bearer\\s+(.+)$/i);\n  const token = m ? m[1].trim() : '';\n  const role = String(request.headers.get('X-Admin-Role') || 'general').trim().toLowerCase();\n\n  const tokens = parseAdminTokens(env);\n  const expected = String(tokens[role] || '').trim();\n  if (!expected || token !== expected) {\n    return { ok: false, role };\n  }\n  return { ok: true, role };\n}\n\nasync function handleSubscribe(request, env) {\n  const body = await request.json().catch(() => null);\n  if (!body || typeof body !== 'object') return json({ ok: false, error: 'invalid_json' }, { status: 400 });\n\n  const email = String(body.email || '').trim().toLowerCase();\n  if (!isEmail(email)) return json({ ok: false, error: 'invalid_email' }, { status: 400 });\n\n  const db = await dbEnsure(env);\n  const ip = getIp(request);\n\n  const turnstile = await verifyTurnstile(env, body.turnstileToken, ip);\n  if (!turnstile.ok) return json({ ok: false, error: turnstile.error }, { status: 400 });\n\n  const { ua } = await upsertSubscriber(db, request, email, body);\n  await recordEvent(db, { type: 'subscribe', email, ip, payload: { ua } });\n\n  const welcomeCampaign = await getWelcomeCampaign(db);\n  if (!welcomeCampaign) return json({ ok: false, error: 'missing_welcome_campaign' }, { status: 500 });\n\n  const requestedCampaignId = getCampaignIdFromRequest(body);\n  const campaign = requestedCampaignId ? await getActiveCampaign(db, requestedCampaignId) : null;\n\n  const welcomeCoupon = await issueCoupon(db, env, { email, campaign: welcomeCampaign });\n  let campaignCoupon = null;\n  if (campaign && campaign.id !== BIENVENIDA_CAMPAIGN_ID) {\n    campaignCoupon = await issueCoupon(db, env, { email, campaign });\n  }\n\n  await recordEvent(db, {\n    type: 'coupon_issued',\n    email,\n    campaignId: campaign ? campaign.id : BIENVENIDA_CAMPAIGN_ID,\n    ip,\n    payload: { welcome: Boolean(welcomeCoupon), campaign: Boolean(campaignCoupon) },\n  });\n\n  const landingUrl = String(env.PUBLIC_LANDING_URL || '').trim();\n  const html = renderCouponEmail({ landingUrl, welcome: welcomeCoupon, campaign: campaignCoupon });\n  const subject = campaignCoupon\r\n    ? 'Tus cupones de bienvenida y campana estan listos - Mahitek 3D Lab'\r\n    : 'Bienvenida a Mahitek 3D Lab: tu cupon esta listo';\n\n  const emailResult = await sendEmail(env, { to: email, subject, html });\n  return json({ ok: true, emailSent: emailResult.ok });\n}\n\nasync function handleAdminCampaigns(request, env) {\n  const db = await dbEnsure(env);\n  const auth = requireAdmin(request, env);\n  if (!auth.ok) return json({ ok: false, error: 'unauthorized' }, { status: 401 });\n\n  if (request.method === 'GET') {\n    const res = await db\n      .prepare(\n        'SELECT id, name, prefix, discount_type AS discountType, discount_value AS discountValue, stackable, stack_group AS stackGroup, active, starts_at AS startsAt, ends_at AS endsAt, created_at AS createdAt, updated_at AS updatedAt FROM campaigns ORDER BY id ASC',\n      )\n      .all();\n    return json({ ok: true, campaigns: res.results || [] });\n  }\n\n  if (request.method === 'POST') {\n    const body = await request.json().catch(() => null);\n    if (!body || typeof body !== 'object') return json({ ok: false, error: 'invalid_json' }, { status: 400 });\n\n    const id = String(body.id || '').trim();\n    const name = String(body.name || '').trim();\n    const prefix = String(body.prefix || '').trim().toUpperCase();\n    const discountType = String(body.discountType || '').trim();\n    const discountValue = Number(body.discountValue);\n\n    if (!/^[A-Z0-9_-]{2,32}$/.test(id)) return json({ ok: false, error: 'invalid_id' }, { status: 400 });\n    if (!name || name.length > 80) return json({ ok: false, error: 'invalid_name' }, { status: 400 });\n    if (!/^[A-Z0-9]{2,12}$/.test(prefix)) return json({ ok: false, error: 'invalid_prefix' }, { status: 400 });\n    if (!['percent', 'amount'].includes(discountType))\n      return json({ ok: false, error: 'invalid_discount_type' }, { status: 400 });\n    if (!Number.isFinite(discountValue) || discountValue <= 0)\n      return json({ ok: false, error: 'invalid_discount_value' }, { status: 400 });\n\n    const stackable = body.stackable ? 1 : 0;\n    const stackGroup = String(body.stackGroup || '').trim() || null;\n    const active = body.active === false ? 0 : 1;\n    const startsAt = body.startsAt ? String(body.startsAt) : null;\n    const endsAt = body.endsAt ? String(body.endsAt) : null;\n\n    const ts = nowIso();\n    await dbExec(\n      db,\n      `\n        INSERT INTO campaigns (id, name, prefix, discount_type, discount_value, stackable, stack_group, active, starts_at, ends_at, created_at, updated_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        ON CONFLICT(id) DO UPDATE SET\n          name = excluded.name,\n          prefix = excluded.prefix,\n          discount_type = excluded.discount_type,\n          discount_value = excluded.discount_value,\n          stackable = excluded.stackable,\n          stack_group = excluded.stack_group,\n          active = excluded.active,\n          starts_at = excluded.starts_at,\n          ends_at = excluded.ends_at,\n          updated_at = excluded.updated_at\n      `,\n      [\n        id,\n        name,\n        prefix,\n        discountType,\n        Math.floor(discountValue),\n        stackable,\n        stackGroup,\n        active,\n        startsAt,\n        endsAt,\n        ts,\n        ts,\n      ],\n    );\n\n    await recordEvent(db, {\n      type: 'admin_action',\n      ip: getIp(request),\n      payload: { action: 'upsert_campaign', role: auth.role, id },\n    });\n\n    return json({ ok: true });\n  }\n\n  return json({ ok: false, error: 'method' }, { status: 405 });\n}\n\nasync function handleAdminStats(request, env) {\n  const db = await dbEnsure(env);\n  const auth = requireAdmin(request, env);\n  if (!auth.ok) return json({ ok: false, error: 'unauthorized' }, { status: 401 });\n\n  const subs = await dbFirst(db, 'SELECT COUNT(*) AS n FROM subscribers', []);\n  const coupons = await dbFirst(db, 'SELECT COUNT(*) AS n FROM coupons', []);\n  const campaigns = await dbFirst(db, 'SELECT COUNT(*) AS n FROM campaigns WHERE active = 1', []);\n  return json({\n    ok: true,\n    stats: {\n      subscribers: subs ? subs.n : 0,\n      coupons: coupons ? coupons.n : 0,\n      activeCampaigns: campaigns ? campaigns.n : 0,\n    },\n  });\n}\n\nexport default {\n  async fetch(request, env) {\n    try {\n      if (request.method === 'OPTIONS') {\n        return corsify(request, new Response(null, { status: 204 }), env);\n      }\n\n      const url = new URL(request.url);\n      const path = url.pathname;\n\n      if (request.method === 'GET' && path === '/health') {\n        return corsify(request, json({ ok: true, name: 'mahiteklab-api' }), env);\n      }\n\n      if (path === '/subscribe' && request.method === 'POST') {\n        return corsify(request, await handleSubscribe(request, env), env);\n      }\n\n      if (path === '/admin/campaigns') {\n        return corsify(request, await handleAdminCampaigns(request, env), env);\n      }\n\n      if (path === '/admin/stats' && request.method === 'GET') {\n        return corsify(request, await handleAdminStats(request, env), env);\n      }\n\n      return corsify(request, json({ ok: false, error: 'not_found' }, { status: 404 }), env);\n    } catch (err) {\n      return corsify(\n        request,\n        json({ ok: false, error: 'server_error' }, { status: 500 }),\n        env,\n      );\n    }\n  },\n};\n\r\n\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"V:\\\\Proyectos_Impresion3D\\\\Landing Page Oficial Mahitek MX\\\\Mahitek_3D_Lab_MX\\\\Mahitek_3D_Lab_MX\\\\workers\\\\mahiteklab-api\\\\src\\\\index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\evega\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\evega\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"V:\\\\Proyectos_Impresion3D\\\\Landing Page Oficial Mahitek MX\\\\Mahitek_3D_Lab_MX\\\\Mahitek_3D_Lab_MX\\\\workers\\\\mahiteklab-api\\\\src\\\\index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"V:\\\\Proyectos_Impresion3D\\\\Landing Page Oficial Mahitek MX\\\\Mahitek_3D_Lab_MX\\\\Mahitek_3D_Lab_MX\\\\workers\\\\mahiteklab-api\\\\.wrangler\\\\tmp\\\\bundle-A0EsGD\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\evega\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"V:\\\\Proyectos_Impresion3D\\\\Landing Page Oficial Mahitek MX\\\\Mahitek_3D_Lab_MX\\\\Mahitek_3D_Lab_MX\\\\workers\\\\mahiteklab-api\\\\.wrangler\\\\tmp\\\\bundle-A0EsGD\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"V:\\\\Proyectos_Impresion3D\\\\Landing Page Oficial Mahitek MX\\\\Mahitek_3D_Lab_MX\\\\Mahitek_3D_Lab_MX\\\\workers\\\\mahiteklab-api\\\\.wrangler\\\\tmp\\\\bundle-A0EsGD\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
